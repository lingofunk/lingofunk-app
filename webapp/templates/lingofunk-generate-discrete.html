{% extends "base.html" %}
{% set current_page_id = 'generate-discrete' %}
{% block title %}Generate{% endblock %}

{% block head %}
<style>
	#output-text {
		display: none;
	}
</style>
{% endblock %}

{% block body %}
<h2 align="center">Text Generator</h2>
<fieldset>
	<legend>Choose text style</legend>
	<div class="form-group">
		<form id="textform" method="post">
			<div class="radio-inline">
				<input type="radio" class="style-option form-check-input" id="positive" value="positive" name="styles">
				<label class="form-check-label" for="positive">positive</label>
				<input type="radio" class="style-option form-check-input" id="negative" value="negative" name="styles">
				<label class="form-check-label" for="negative">negative</label>
				<input type="radio" class="style-option form-check-input" id="neutral" value="neutral" name="styles">
				<label class="form-check-label" for="neutral">neutral</label>
			</div>
		</form>
	</div>
</fieldset>
<div>
	<button type="submit" id="btn-submit" class="btn btn-success" onclick="onClickSubmit()" disabled>
		Generate
	</button>
	<div class="loader" id="loader"></div>
</div>
<div id="output">
	<textarea class="form-control" id="output-text" name="output-text" rows="5" placeholder=""></textarea>
</div>
{% endblock %}

{% block scripts %}
<script>
	const onClickSubmit = function (event) {
		const url = "/api/generator/discrete"; // use your endpoint
		$.ajax({
			url: url,
			type: 'POST',
			contentType: 'application/json',
			datatype: 'json',
			data: JSON.stringify({
				// add here any additional value, such as range or options
				'style-name': $(".style-option:checked").val()
			}),
			success: function (result) {
				// place here any display functions
				console.log(result);
				let parsedResults = JSON.parse(result);
				$('#output-text').val(parsedResults.text);
				$('#output-text').css('display', 'block');
			}
		});
	};


	$("input:radio").change(
		() => {
			$("#btn-submit").prop("disabled", false);
		}
	);

	const spinnerHide = () => {
		$('#loader').css('display', 'none');
	}
	const spinnerShow = () => {
		$('#loader').css('display', 'inline-block');
	}

	spinnerHide();

	$(document)
		.ajaxStart(function () {
			spinnerShow()
			$("#btn-submit").prop("disabled", true);
			$("input:radio").prop("disabled", true);
		})
		.ajaxStop(function () {
			spinnerHide();
			$("#btn-submit").prop("disabled", false);
			$("input:radio").prop("disabled", false);
		});

</script>
{% endblock %}